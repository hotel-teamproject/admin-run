version: '3.8'

services:
  mongodb:
    image: mongo:latest
    container_name: hotel-mongo
    restart: always
    ports:
      - "27017:27017"
    environment:
      MONGO_INITDB_DATABASE: ${MONGO_INITDB_DATABASE:-hotel-project}
    volumes:
      - mongodb_data:/data/db
    networks:
      - hotel-network

  backend:
    build:
      context: ./backend-admin-main
      dockerfile: Dockerfile.dev
    container_name: hotel-backend
    restart: always
    ports:
      - "4000:4000"       # üëà Î∞ñÏóêÏÑú 4000Î≤àÏúºÎ°ú Îì§Ïñ¥Ïò¥
    environment:
      - MONGODB_URI=${MONGODB_URI:-mongodb://hotel-mongo:27017/hotel-project}
      - MONGO_URI=${MONGO_URI:-mongodb://hotel-mongo:27017/hotel-project}
      - JWT_SECRET=${JWT_SECRET}
      - JWT_EXPIRES_IN=${JWT_EXPIRES_IN:-1h}
      - REFRESH_TOKEN_SECRET=${REFRESH_TOKEN_SECRET:-${JWT_SECRET}}
      - REFRESH_EXPIRES_IN=${REFRESH_EXPIRES_IN:-7d}
      - PORT=${PORT:-4000}
      - NODE_ENV=${NODE_ENV:-development}
      - FRONT_ORIGIN=${FRONT_ORIGIN:-http://localhost:5173}
    depends_on:
      - mongodb
    volumes:
      - ./backend-admin-main:/app
      - /app/node_modules
    networks:
      - hotel-network
    command: npm run dev

  frontend:
    build:
      context: ./frontend-admin-main
      dockerfile: Dockerfile.dev
    container_name: hotel-frontend
    restart: always
    ports:
      - "5173:5173"
    environment:
      - VITE_API_URL=${VITE_API_URL:-http://localhost:4000/api}
    volumes:
      - ./frontend-admin-main:/app
      - /app/node_modules
    networks:
      - hotel-network
    command: npm run dev -- --host

volumes:
  mongodb_data:

networks:
  hotel-network:
    driver: bridge